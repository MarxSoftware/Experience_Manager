function openCity(evt, cityName) {
	evt.preventDefault();
	var i, tabcontent, tablinks;
	tabcontent = document.getElementsByClassName("tabcontent");
	for (i = 0; i < tabcontent.length; i++) {
		tabcontent[i].style.display = "none";
	}
	tablinks = document.getElementsByClassName("tablinks");
	for (i = 0; i < tablinks.length; i++) {
		tablinks[i].className = tablinks[i].className.replace(" active", "");
	}
	document.getElementById(cityName).style.display = "block";
	evt.currentTarget.className += " active";
}

function exm_content_update_preview() {
	// html content to write in preview-iframe
	// var iframeContent = '<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge">' + '<style>' + cssEditor.getValue() + '</style>' + '</head><body>' + htmlEditor.getValue() + '\n<script>' + jsEditor.getValue() + '<\/script>' + '</body></html>';
	var iframeContent = '<!DOCTYPE html>\n<html lang="en">\n\t<head>\n\t<meta charset="UTF-8">\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t<meta http-equiv="X-UA-Compatible" content="ie=edge">' +
			'\n\t\t<style>' + '\n\t\t\t' + EXM.cssEditor.getValue() + '\n\t\t</style>' + '\n\t</head>\n\t<body>' + '\n\t' + EXM.htmlEditor.getValue() + '\n\t<script>' + '\n\t\t\t' + EXM.jsEditor.getValue() + '\n\t<\/script>\n\t</body>\n</html>';
	// get document object from window object generated by the preview-iframe
	var target = jQuery('#exm-preview-target')[0].contentWindow.document;
	// opens the document stream for writing
	target.open();
	// writes text in the document
	target.write(iframeContent);
	// closes the document stream for writing
	target.close();
}

if (!window.EXM) {
	window.EXM = {};
}
jQuery(function () {

	document.getElementById("defaultOpen").click();

	EXM.htmlEditor = ace.edit("html-editor");
	EXM.htmlEditor.session.setMode("ace/mode/html");
	EXM.htmlEditor.session.setTabSize(4);
	EXM.htmlEditor.setValue(window.exmContentEditorValue.html);

	EXM.cssEditor = ace.edit("css-editor");
	EXM.cssEditor.session.setMode("ace/mode/css");
	EXM.cssEditor.session.setTabSize(4);
	EXM.cssEditor.setValue(window.exmContentEditorValue.css);

	EXM.jsEditor = ace.edit("js-editor");
	EXM.jsEditor.session.setMode("ace/mode/javascript");
	EXM.jsEditor.session.setTabSize(2);
	EXM.jsEditor.setValue(window.exmContentEditorValue.js);

	exm_content_update_preview();

	jQuery('.exm-content-editor .editor').on('keyup', function () {
		document.querySelector("#exm_content_editor_css").value = EXM.cssEditor.getValue();
		document.querySelector("#exm_content_editor_js").value = EXM.jsEditor.getValue();
		document.querySelector("#exm_content_editor_html").value = EXM.htmlEditor.getValue();

		exm_content_update_preview();
	});
});